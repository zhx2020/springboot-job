<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>个人中心</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
    <script src="/js/init.js"></script>
    <link rel="stylesheet" href="/css/base.css">
</head>
<body>
<div id="header">
    <div class="content">
        <div class="left">基于springboot的职位数据采集分析平台</div>
        <div class="right">
            <ul>
                <li class="index"><a href="/index">首页</a></li>
                <li><a href="/search" class="limit">职位搜索</a></li>
                <li><a href="/store" class="limit">我的收藏</a></li>
                <li><a href="/discuss" class="limit">讨论区</a></li>
                <li><a href="/issue" class="limit">我的发布</a></li>
                <li><a href="/chat" class="limit">好友聊天</a></li>
                <li><a href="/center" class="limit cur">个人中心</a></li>
            </ul>
        </div>
    </div>
</div>
<div id="main">
    <div class="content pt80">
        <form class="form-horizontal">
            <div class="form-group form-group-sm">
                <label class="col-md-5 control-label">手机号</label>
                <div class="col-md-3">
                    <input id="phone" type="text" class="form-control" disabled>
                </div>
            </div>
            <div class="form-group form-group-sm">
                <label class="col-md-5 control-label">用户名</label>
                <div class="col-md-3">
                    <input id="name" type="text" class="form-control" disabled>
                </div>
            </div>
            <div class="form-group form-group-sm">
                <label class="col-md-5 control-label">密码</label>
                <div class="col-md-3">
                    <input id="pass" type="password" class="form-control">
                </div>
            </div>
            <div class="form-group form-group-sm">
                <label class="col-md-5 control-label">行业方向</label>
                <div class="col-md-3">
                    <select id="position" class="form-control">
                        <option value="0">请选择</option>
                        <option value="1">java</option>
                        <option value="2">php</option>
                        <option value="3">c/c++</option>
                        <option value="4">python</option>
                        <option value="5">android</option>
                        <option value="6">ios</option>
                        <option value="7">web</option>
                        <option value="8">html5</option>
                        <option value="9">测试</option>
                        <option value="10">运维</option>
                    </select>
                </div>
            </div>
            <div class="form-group form-group-sm">
                <label class="col-md-5 control-label">期望薪资</label>
                <div class="col-md-3">
                    <select id="salary" class="form-control">
                        <option value="0">请选择</option>
                        <option value="1">1k-3k</option>
                        <option value="2">3k-5k</option>
                        <option value="3">5k-8k</option>
                        <option value="4">8k-10k</option>
                        <option value="5">10k-15k</option>
                        <option value="6">15k-20k</option>
                        <option value="7">20k-25k</option>
                        <option value="8">25k-30k</option>
                    </select>
                </div>
            </div>
            <div class="form-group form-group-sm">
                <label class="col-md-5 control-label">工作地点</label>
                <div class="col-md-3">
                    <select id="area" class="form-control">
                        <option value="0">请选择</option>
                        <option value="1">北京</option>
                        <option value="2">上海</option>
                        <option value="3">广州</option>
                        <option value="4">深圳</option>
                    </select>
                </div>
            </div>
            <div class="form-group form-group-sm">
                <label class="col-md-5 control-label">工作年限</label>
                <div class="col-md-3">
                    <select id="year" class="form-control">
                        <option value="0">请选择</option>
                        <option value="1">在校生/应届生</option>
                        <option value="2">1年经验</option>
                        <option value="3">2年经验</option>
                        <option value="4">3-4年经验</option>
                        <option value="5">5-7年经验</option>
                        <option value="6">8-9年经验</option>
                        <option value="7">10年经验以上</option>
                    </select>
                </div>
            </div>
            <div class="form-group form-group-sm">
                <label class="col-md-5 control-label">当前学历</label>
                <div class="col-md-3">
                    <select id="education" class="form-control">
                        <option value="0">请选择</option>
                        <option value="1">初中及以下</option>
                        <option value="2">高中</option>
                        <option value="3">中技</option>
                        <option value="4">中专</option>
                        <option value="5">大专</option>
                        <option value="6">本科</option>
                        <option value="7">硕士</option>
                        <option value="8">博士</option>
                    </select>
                </div>
            </div>
            <div class="form-group form-group-sm">
                <label class="col-md-5 control-label">操作</label>
                <div class="col-md-3">
                    <button id="modify" type="button" class="btn btn-success btn-sm btn-block">修改</button>
                </div>
            </div>
        </form>
    </div>
</div>
<div id="footer">
    <div class="content">
        Copyright © 2016-2020 Echo
    </div>
</div>
<script>
    $(function () {
        // 获取当前用户的信息
        $.ajax({
            type: "get",
            url: "http://localhost:8080/user/findById?id=" + $.cookie("name"),
            success: function (res) {
                $("#phone").val(res.userId);
                $("#name").val(res.userName);
                $("#pass").val(res.userPass);
                $(`#position>option[value=${res.positionId}]`).attr("selected", true);
                $(`#salary>option[value=${res.salaryId}]`).attr("selected", true);
                $(`#area>option[value=${res.areaId}]`).attr("selected", true);
                $(`#year>option[value=${res.yearId}]`).attr("selected", true);
                $(`#education>option[value=${res.educationId}]`).attr("selected", true);
            }
        });

        // 修改用户信息
        var modifyBtn = $("#modify");
        modifyBtn.click(function () {
            var phone = $("#phone").val();
            var userName = $("#name").val();
            var userPass = $("#pass").val();
            var positionId = $("#position>option:selected").val();
            var salaryId = $("#salary>option:selected").val();
            var areaId = $("#area>option:selected").val();
            var yearId = $("#year>option:selected").val();
            var educationId = $("#education>option:selected").val();
            $.ajax({
                type: "post",
                url: "http://localhost:8080/user/modify",
                contentType: "application/json;charset=UTF-8",
                data: JSON.stringify({
                    "userId": phone,
                    "userName": userName,
                    "userPass": userPass,
                    "positionId": positionId,
                    "salaryId": salaryId,
                    "areaId": areaId,
                    "yearId": yearId,
                    "educationId": educationId
                }),
                success: function (res) {
                    if (res.flag) {
                        alert(res.message);
                        window.location.reload();
                    } else {
                        alert(res.message);
                    }
                }
            });
        })
    })
</script>
</body>
</html>